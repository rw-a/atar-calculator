{"version":3,"file":"static/js/834.376644f5.chunk.js","mappings":"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","sources":["modules/scaling.js"],"sourcesContent":["import './../css/scaling.css';\nimport React from 'react';\nimport JXG, { COORDS_BY_SCREEN } from 'jsxgraph';\n\nimport { calculateScaledScore } from './results';\n\nimport SUBJECTS from '../data/all_subjects.json';\nimport { getScalingData } from './data';\n  \nconst COLORS = [\n  'steelblue',\n  'orangered',\n  '#05b378', // green\n  'darkviolet',\n  'orange',\n  'brown',\n  'magenta'\n];\n\nconst BOUNDING_BOX = [-9, 103, 113, -6]; // min x, max y, max x, min y\n\nconst LEGEND_WIDTH = 110;\n\nconst SUBJECT_LABELS_ZOOM_THRESHOLD = 1.7;\nconst MOBILE_LEGEND_ZOOM_THRESHOLD = 10;\n\n// replace default font\nJXG.Options.text.cssDefaultStyle = 'z-index: 0';\nJXG.Options.text.highlightCssDefaultStyle = '';\n\nexport default class ScalingGraph extends React.Component {\n  componentDidMount() {\n    this.board = JXG.JSXGraph.initBoard(\"jsxgraph\", { \n      axis: true, \n      maxFrameRate: 30,\n      boundingbox: BOUNDING_BOX, \n      maxboundingbox: [-100, 200, 200, -100],\n      showCopyright: false, \n      showInfobox: false,\n      // showNavigation: false,\n      zoom: {\n        factorX: 1.25,  // horizontal zoom factor (multiplied to JXG.Board#zoomX)\n        factorY: 1.25,  // vertical zoom factor (multiplied to JXG.Board#zoomY)\n        wheel: true,     // allow zooming by mouse wheel or\n                   // by pinch-to-toom gesture on touch devices\n        needShift: false,   // mouse wheel zooming needs pressing of the shift key\n        min: 1,        // minimal values of JXG.Board#zoomX and JXG.Board#zoomY, limits zoomOut\n        max: 50,       // maximal values of JXG.Board#zoomX and JXG.Board#zoomY, limits zoomIn\n      \n        pinchHorizontal: false, // Allow pinch-to-zoom to zoom only horizontal axis\n        pinchVertical: false,   // Allow pinch-to-zoom to zoom only vertical axis\n        pinchSensitivity: 7    // Sensitivity (in degrees) for recognizing horizontal or vertical pinch-to-zoom gestures.\n      },\n      pan: {\n        enabled: true,   // Allow panning\n        needTwoFingers: false, // panning is done with two fingers on touch devices\n        needShift: false, // mouse panning needs pressing of the shift key\n      },\n      navbar:  {\n        strokeColor: '#333333',\n        fillColor: 'transparent',\n        highlightFillColor: '#aaaaaa',\n        padding: '0px',\n        position: 'absolute',\n        fontSize: '14px',\n        cursor: 'pointer',\n        zIndex: '100',\n        right: '5px',\n        bottom: '0px',\n      }\n    });\n    \n    this.legend = JXG.JSXGraph.initBoard(\"jsxlegend\", { \n      boundingbox: [0, 120, 20, 0], // min x, max y, max x, min y\n      maxFrameRate: 1,\n      registerEvents: false,\n      showCopyright: false, \n      showInfobox: false,\n      showNavigation: false,\n      zoom: {\n        factorX: 1, \n        factorY: 1, \n        wheel: false,    \n        needShift: true, \n        min: 1,      \n        max: 1, \n      \n        pinchHorizontal: false,\n        pinchVertical: false, \n        pinchSensitivity: 7 \n      },\n      pan: {\n        enabled: false,\n        needTwoFingers: true,\n        needShift: true,\n      },\n    }); \n\n    this.addZoomLevelListeners(); // this could be further optimised by only updating subject label listener, not whole legend listener\n    this.createMouseCoordinates();\n\n    this.originalObjects = [...this.board.objectsList]; // this needs to be after the mouse coordinates is created so it is preserved\n    this.points = [];\n    this.subjects = [];\n    this.year = 2022;\n\n    this.componentDidUpdate();\n  }\n\n  clearBoard() {\n    let objectsList = [...this.board.objectsList];\n    for (let index = objectsList.length - 1; index >= 0; index -= 1) {\n      let object = objectsList[index];\n      if (object.elType === \"line\" || object.elType === \"curve\" || (object.elType === \"text\" && object.visProp.cssclass !== \"mouseCoordinates\") || (object.elType === \"point\" && object.Xjc !== null) || !this.originalObjects.includes(object))\n        this.board.removeObject(object.id);\n    }\n  }\n\n  plotScalingFunctions() {\n    for (let [subjectIndex, subjectCode] of this.subjects.entries()) {  // entries on a list does enumerate\n      // create function\n      const scalingData = getScalingData(this.props.year);\n      let a = scalingData[subjectCode][\"a\"];\n      let b = scalingData[subjectCode][\"b\"];\n      let c = scalingData[subjectCode][\"c\"];\n      let subjectFunction = this.board.create('functiongraph', [function(x){\n        return (a / (1 + Math.exp(-b * (x - c))));\n      }, 0, 100], {strokeColor: COLORS[subjectIndex % COLORS.length]});   // modulus ensures colours repeat if exhausted\n      subjectFunction.hasPoint = function(x, y) {return false;}; // disable highlighting\n    }\n  }\n\n  clearLegend() {\n    let legendObjectsList = [...this.legend.objectsList];\n    for (let index = legendObjectsList.length - 1; index >= 0; index -= 1) {\n      let object = legendObjectsList[index];\n      this.legend.removeObject(object.id);\n    }\n  }\n\n  createLegend() {\n    let subjectsNames = this.subjects.map((subjectCode) => {return SUBJECTS[subjectCode]});\n    let longestSubjectName = subjectsNames.reduce((subject1, subject2) => {return (subject1.length > subject2.length) ? subject1 : subject2});\n    let numLines = Math.ceil(longestSubjectName.length / 12);\n    let rowHeight = numLines * 9 + 10;\n\n    let legend = this.legend.create('legend', [0, 100], {labels: subjectsNames, colors: COLORS, rowHeight: rowHeight} );\n\n    let legendHeight = legend.lines.at(-1).getTextAnchor().scrCoords.at(-1) + rowHeight + this.maxWidth / 30;\n    document.getElementById('jsxlegend').style.top = `${this.graphHeight - legendHeight}px`;\n    this.legend.resizeContainer(LEGEND_WIDTH, legendHeight, false, true);\n  }\n\n  plotPoints() {\n    // determine whether to show the points, at the current zoom level\n    let boundingBox = this.board.getBoundingBox();\n    let zoomFactor = (BOUNDING_BOX[2] - BOUNDING_BOX[0]) / (boundingBox[2] - boundingBox[0]);\n    let showLabels = (zoomFactor >= SUBJECT_LABELS_ZOOM_THRESHOLD);\n\n    for (let subjectCode of this.subjects) {\n      // plot raw score input\n      let rawScore = this.props.subjects[subjectCode];\n      if (rawScore) {\n        let scaledScore = calculateScaledScore(rawScore, subjectCode, this.props.year);\n        let point = this.board.create('point', [rawScore, scaledScore], {face: \"cross\", name: SUBJECTS[subjectCode], withLabel: true});\n        point.label.setAttribute({offset: [10, -4]});\n        if (!showLabels) point.setAttribute({withLabel: false});\n        point.hasPoint = function(x, y) {return false;}; // disable highlighting\n        this.points.push(point);\n      }\n    }\n  }\n\n  // static method\n  zoomFactorChange(zoomFactor, previousZoomFactor, thresholdZoomFactor) {\n    // tests whether the zoom factor has crossed the threshold (for optimisation purposes so no redundant attribute setting)\n    if (zoomFactor >= thresholdZoomFactor) {\n      return previousZoomFactor < thresholdZoomFactor;\n    } else {\n      return previousZoomFactor > thresholdZoomFactor;\n    }\n  }\n\n  addZoomLevelListeners() {\n    // show/hide labels and/or legend depending on zoom level\n    let previousZoomFactor = 1;\n    this.board.on('boundingbox', () => {\n      let boundingBox = this.board.getBoundingBox();\n      let zoomFactor = (BOUNDING_BOX[2] - BOUNDING_BOX[0]) / (boundingBox[2] - boundingBox[0]);\n      \n      // show/hide subject labels\n      if (this.zoomFactorChange(zoomFactor, previousZoomFactor, SUBJECT_LABELS_ZOOM_THRESHOLD)) {\n        this.board.suspendUpdate();\n        let showLabels = (zoomFactor >= SUBJECT_LABELS_ZOOM_THRESHOLD);\n        for (let point of this.points) {\n          point.setAttribute({withLabel: showLabels});\n        }\n        this.board.unsuspendUpdate();\n      }\n      \n      // show/hide legend (only for mobile)\n      if (this.isMobile && this.zoomFactorChange(zoomFactor, previousZoomFactor, MOBILE_LEGEND_ZOOM_THRESHOLD)) {\n        document.getElementById('jsxlegend').style.display = (zoomFactor >= MOBILE_LEGEND_ZOOM_THRESHOLD) ? 'none' : ''; // none is hidden, blank is shown\n      }\n\n      previousZoomFactor = zoomFactor;\n    }); \n  }\n\n  createMouseCoordinates() {\n     // create coordinates at mouse\n     let mouseCoordinates = this.board.create('point', [0, 0], {\n      visible: false,\n      fixed: true,\n      size: 2, \n      fillColor: 'black', \n      highlightFillColor: 'black', \n      fillOpacity: 0.7, \n      highlightFillOpacity: 0.7, \n      highlightStrokeWidth: 0,\n      strokeWidth: 0,   // disable stroke so only fill is considered\n      precision: {  // ensures always highlighted\n        touch: 0,\n        mouse: 0,\n        pen: 0\n      }\n    });\n    mouseCoordinates.label.setAttribute({offset: [7, 13]}); // set offset of coordinates at mouse\n    mouseCoordinates.label.setAttribute({cssClass: \"mouseCoordinates\"});\n\n    // update position of mouse coordinates\n    let previousCoordinates = [0, 0];   // tracks whether there has been a change in coordinates (only update on change for optimisation)\n    let previouslyVisible = false;      // tracks whether coordinates were previously shown (for optimisation)\n    let updateMouseCoordinates = () => {\n      if (this.subjects.length < 1) return false;\n\n      let coords = new JXG.Coords(COORDS_BY_SCREEN, this.board.getMousePosition(), this.board).usrCoords.slice(1);\n      let nearestX = Math.round(coords[0]);\n\n      if (nearestX >= -1 && nearestX <= 101) {\n        // adds leeway so you don't have to get exactly 0 or 100\n        if (nearestX <= 0) nearestX = 0;\n        if (nearestX >= 100) nearestX = 100;  \n\n        // pick the closest subject to select\n        let closestSubject = this.subjects.reduce((subjectCode1, subjectCode2) => {  // get the subject with raw score closest to the cursor\n          return (Math.abs(calculateScaledScore(nearestX, subjectCode1, this.props.year) - coords[1]) < Math.abs(calculateScaledScore(nearestX, subjectCode2, this.props.year) - coords[1])) ? subjectCode1 : subjectCode2;\n        })\n        let nearestY = calculateScaledScore(nearestX, closestSubject, this.props.year);\n\n        // show coordinates if previously hidden\n        if (!previouslyVisible) {\n          this.board.suspendUpdate();\n          mouseCoordinates.showElement();\n          previouslyVisible = true;\n        }\n\n        // only update if the coordinates have actually changed\n        let coordinates = [nearestX, nearestY];\n        if (nearestX === previousCoordinates[0] && nearestY === previousCoordinates[1]) return false;\n        previousCoordinates = coordinates;\n        \n        // move the point to the mouse and update it's name to be it's coordinate\n        this.board.suspendUpdate();\n        mouseCoordinates.moveTo(coordinates);\n        mouseCoordinates.setAttribute({name: `(${nearestX.toFixed(0)}, ${nearestY.toFixed(2)})`});\n        this.board.unsuspendUpdate();\n      } else {\n        if (previouslyVisible) {\n          mouseCoordinates.hideElement();\n          previouslyVisible = false;\n        }\n      }\n    }\n    this.board.on('touchstart', updateMouseCoordinates);\n    this.board.on('pointermove', updateMouseCoordinates);\n  }\n\n  clearPoints() {\n    // clear the points which show the raw score inputted but not the graphs. useful if only the raw score changes and not the subjects\n    let objectsList = [...this.board.objectsList];\n    for (let index = objectsList.length - 1; index >= 0; index -= 1) {\n      let object = objectsList[index];\n      if ((object.elType === \"point\" && object.Xjc !== null))\n        this.board.removeObject(object.id);\n    }\n  }\n\n  componentDidUpdate() {\n    this.board.suspendUpdate();\n    this.legend.suspendUpdate();\n\n    let previousSubjects = [...this.subjects];\n    this.subjects = Object.keys(this.props.subjects).filter((subjectCode) => {return this.props.subjects[subjectCode] !== undefined}); // this is a list, whereas this.props.subjects is an object\n    this.subjectsHaveChanged = !(JSON.stringify(previousSubjects) === JSON.stringify(this.subjects));\n    \n    if (this.subjectsHaveChanged || this.year !== this.props.year) {\n      this.year = this.props.year;  // track the year that was previously to check whether the year has changed\n      this.clearBoard();\n      if (this.subjects.length > 0) this.plotScalingFunctions();\n    }\n    if (this.subjectsHaveChanged) {\n      this.clearLegend();\n      if (this.subjects.length > 0) this.createLegend();\n    } else {\n      this.clearPoints();\n    }\n    this.plotPoints();\n\n    this.board.unsuspendUpdate();\n    this.legend.unsuspendUpdate();\n  }\n\n  render() {\n    this.isMobile = this.maxWidth < 400;\n\n    this.maxWidth = document.querySelector('.section-inner').getBoundingClientRect().width;\n    this.graphHeight = Math.abs(this.maxWidth * (BOUNDING_BOX[1] - BOUNDING_BOX[3]) / (BOUNDING_BOX[2] - BOUNDING_BOX[0]));  // ensures that 1x1 aspect ratio is maintained\n    \n    return(\n      <div style={{position: \"relative\"}}>\n        <div id=\"jsxgraph\" style={{width: this.maxWidth, height: this.graphHeight}}></div>\n        <div id=\"jsxlegend\" style={{position: \"absolute\", top: this.graphHeight - 250 /* estimate, will be accurately calculated later */, right: 0, width: LEGEND_WIDTH, height: this.graphHeight, zIndex: -1}}></div>\n      </div>\n    );\n  }\n}"],"names":["COLORS","BOUNDING_BOX","JXG","ScalingGraph","this","board","axis","maxFrameRate","boundingbox","maxboundingbox","showCopyright","showInfobox","zoom","factorX","factorY","wheel","needShift","min","max","pinchHorizontal","pinchVertical","pinchSensitivity","pan","enabled","needTwoFingers","navbar","strokeColor","fillColor","highlightFillColor","padding","position","fontSize","cursor","zIndex","right","bottom","legend","registerEvents","showNavigation","addZoomLevelListeners","createMouseCoordinates","originalObjects","objectsList","points","subjects","year","componentDidUpdate","index","length","object","elType","visProp","cssclass","Xjc","includes","removeObject","id","entries","subjectIndex","subjectCode","scalingData","getScalingData","props","a","b","c","create","x","Math","exp","hasPoint","y","legendObjectsList","subjectsNames","map","SUBJECTS","longestSubjectName","reduce","subject1","subject2","rowHeight","ceil","legendHeight","labels","colors","lines","at","getTextAnchor","scrCoords","maxWidth","document","getElementById","style","top","graphHeight","resizeContainer","boundingBox","getBoundingBox","showLabels","rawScore","scaledScore","calculateScaledScore","point","face","name","withLabel","label","setAttribute","offset","push","zoomFactor","previousZoomFactor","thresholdZoomFactor","on","zoomFactorChange","suspendUpdate","unsuspendUpdate","isMobile","display","mouseCoordinates","visible","fixed","size","fillOpacity","highlightFillOpacity","highlightStrokeWidth","strokeWidth","precision","touch","mouse","pen","cssClass","previousCoordinates","previouslyVisible","updateMouseCoordinates","coords","COORDS_BY_SCREEN","getMousePosition","usrCoords","slice","nearestX","round","closestSubject","subjectCode1","subjectCode2","abs","nearestY","showElement","coordinates","moveTo","toFixed","hideElement","previousSubjects","Object","keys","filter","undefined","subjectsHaveChanged","JSON","stringify","clearBoard","plotScalingFunctions","clearLegend","createLegend","clearPoints","plotPoints","querySelector","getBoundingClientRect","width","height","React"],"sourceRoot":""}